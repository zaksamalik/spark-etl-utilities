import org.scalatest.FunSuite

import com.civicboost.spark.etl.utilities.GeneralFunctions
import com.civicboost.spark.etl.utilities.DateTimeFunctions

/* ~~~~~~~~~~ General Functions ~~~~~~~~~~*/
class CleanStringTest extends FunSuite {
  test("GeneralFunctions.cleanString") {
    assert(GeneralFunctions.cleanString("\u0000") == "")
    assert(GeneralFunctions.cleanString(null) == null)
    assert(GeneralFunctions.cleanString("") == "")
    assert(GeneralFunctions.cleanString("abc ") == "abc")
    assert(GeneralFunctions.cleanString("abc 123\u0000") == "abc 123")
  }
}

class EmptyStringToNullTest extends FunSuite {
  test("GeneralFunctions.emptyStringToNull") {
    assert(GeneralFunctions.emptyStringToNull(" ") == null)
    assert(GeneralFunctions.emptyStringToNull("") == null)
    assert(GeneralFunctions.emptyStringToNull(null) == null)
    assert(GeneralFunctions.emptyStringToNull("abc ") == "abc ")
    assert(GeneralFunctions.emptyStringToNull("abc 123\u0000") == "abc 123\u0000")
  }
}

class MapBooleansTest extends FunSuite {
  test("GeneralFunctions.mapBooleansYNU") {
    // N
    assert(GeneralFunctions.mapBooleansYNU(false) == "N")
    assert(GeneralFunctions.mapBooleansYNU(0) == "N")
    assert(GeneralFunctions.mapBooleansYNU("0") == "N")
    assert(GeneralFunctions.mapBooleansYNU("f") == "N")
    assert(GeneralFunctions.mapBooleansYNU("F") == "N")
    assert(GeneralFunctions.mapBooleansYNU("false") == "N")
    assert(GeneralFunctions.mapBooleansYNU("False") == "N")
    assert(GeneralFunctions.mapBooleansYNU("FALSE") == "N")
    assert(GeneralFunctions.mapBooleansYNU("n") == "N")
    assert(GeneralFunctions.mapBooleansYNU("N") == "N")
    assert(GeneralFunctions.mapBooleansYNU("no") == "N")
    assert(GeneralFunctions.mapBooleansYNU("No") == "N")
    assert(GeneralFunctions.mapBooleansYNU("NO") == "N")
    // Y
    assert(GeneralFunctions.mapBooleansYNU(true) == "Y")
    assert(GeneralFunctions.mapBooleansYNU(1) == "Y")
    assert(GeneralFunctions.mapBooleansYNU("1") == "Y")
    assert(GeneralFunctions.mapBooleansYNU("t") == "Y")
    assert(GeneralFunctions.mapBooleansYNU("T") == "Y")
    assert(GeneralFunctions.mapBooleansYNU("true") == "Y")
    assert(GeneralFunctions.mapBooleansYNU("True") == "Y")
    assert(GeneralFunctions.mapBooleansYNU("TRUE") == "Y")
    assert(GeneralFunctions.mapBooleansYNU("y") == "Y")
    assert(GeneralFunctions.mapBooleansYNU("Y") == "Y")
    assert(GeneralFunctions.mapBooleansYNU("yes") == "Y")
    assert(GeneralFunctions.mapBooleansYNU("Yes") == "Y")
    assert(GeneralFunctions.mapBooleansYNU("YES") == "Y")
    // Unknown
    assert(GeneralFunctions.mapBooleansYNU("") == "Unknown")
    assert(GeneralFunctions.mapBooleansYNU(" ") == "Unknown")
    assert(GeneralFunctions.mapBooleansYNU(3) == "Unknown")
    assert(GeneralFunctions.mapBooleansYNU(3.0) == "Unknown")
    assert(GeneralFunctions.mapBooleansYNU(null) == "Unknown")
    assert(GeneralFunctions.mapBooleansYNU("foo") == "Unknown")
    assert(GeneralFunctions.mapBooleansYNU("BAR") == "Unknown")
  }
}

class StringIsNumberTest extends FunSuite {
  test("GeneralFunctions.stringIsNumber") {
    assert(GeneralFunctions.stringIsNumber("100"))
    assert(GeneralFunctions.stringIsNumber("-100"))
    assert(GeneralFunctions.stringIsNumber("(100)"))
    assert(GeneralFunctions.stringIsNumber("$100"))
    assert(GeneralFunctions.stringIsNumber("-$100"))
    assert(GeneralFunctions.stringIsNumber("($100)"))
    assert(GeneralFunctions.stringIsNumber("100%"))
    assert(GeneralFunctions.stringIsNumber("-100%"))
    assert(GeneralFunctions.stringIsNumber("(100%)"))
    //
    assert(GeneralFunctions.stringIsNumber("100.00"))
    assert(GeneralFunctions.stringIsNumber("-100.00"))
    assert(GeneralFunctions.stringIsNumber("(100.00)"))
    assert(GeneralFunctions.stringIsNumber("$100.00"))
    assert(GeneralFunctions.stringIsNumber("-$100.00"))
    assert(GeneralFunctions.stringIsNumber("($100.00)"))
    assert(GeneralFunctions.stringIsNumber("100.00%"))
    assert(GeneralFunctions.stringIsNumber("-100.00%"))
    assert(GeneralFunctions.stringIsNumber("(100.00%)"))
    //
    assert(GeneralFunctions.stringIsNumber("100 Apples"))
    assert(GeneralFunctions.stringIsNumber("$3.14/lb."))
    assert(GeneralFunctions.stringIsNumber("4 294 967 295,000"))
    assert(GeneralFunctions.stringIsNumber("4 294 967.295,000"))
    assert(GeneralFunctions.stringIsNumber("4.294.967.295,000"))
    assert(GeneralFunctions.stringIsNumber("4,294,967,295.00"))
    //
    assert(!GeneralFunctions.stringIsNumber(null))
    assert(!GeneralFunctions.stringIsNumber(""))
    assert(!GeneralFunctions.stringIsNumber(" "))
    assert(!GeneralFunctions.stringIsNumber("foo"))
  }
}

class StringToDoubleTest extends FunSuite {
  test("GeneralFunctions.stringToDouble") {
    assert(GeneralFunctions.stringToDoubleBase("100").contains(100.00))
    assert(GeneralFunctions.stringToDoubleBase("100").contains(100.00))
    assert(GeneralFunctions.stringToDoubleBase("-100").contains(-100.00))
    assert(GeneralFunctions.stringToDoubleBase("(100)").contains(-100.00))
    assert(GeneralFunctions.stringToDoubleBase("$100").contains(100.00))
    assert(GeneralFunctions.stringToDoubleBase("-$100").contains(-100.00))
    assert(GeneralFunctions.stringToDoubleBase("($100)").contains(-100.00))
    assert(GeneralFunctions.stringToDoubleBase("100%").contains(100.00))
    assert(GeneralFunctions.stringToDoubleBase("-100%").contains(-100.00))
    assert(GeneralFunctions.stringToDoubleBase("(100%)").contains(-100.00))
    //
    assert(GeneralFunctions.stringToDoubleBase("100.00").contains(100.00))
    assert(GeneralFunctions.stringToDoubleBase("-100.00").contains(-100.00))
    assert(GeneralFunctions.stringToDoubleBase("(100.00)").contains(-100.00))
    assert(GeneralFunctions.stringToDoubleBase("$100.00").contains(100.00))
    assert(GeneralFunctions.stringToDoubleBase("-$100.00").contains(-100.00))
    assert(GeneralFunctions.stringToDoubleBase("($100.00)").contains(-100.00))
    assert(GeneralFunctions.stringToDoubleBase("100.00%").contains(100.00))
    assert(GeneralFunctions.stringToDoubleBase("-100.00%").contains(-100.00))
    assert(GeneralFunctions.stringToDoubleBase("(100.00%)").contains(-100.00))
    //
    assert(GeneralFunctions.stringToDoubleBase("100 Apples").contains(100.00))
    assert(GeneralFunctions.stringToDoubleBase("$3.14/lbs.").contains(3.14))
    assert(GeneralFunctions.stringToDoubleBase("4,294,967,295.00").contains(4294967295.00))
    assert(GeneralFunctions.stringToDoubleBase("4 294 967 295,000", comma_for_decimal = true).contains(4294967295.00))
    assert(GeneralFunctions.stringToDoubleBase("4 294 967.295,000", comma_for_decimal = true).contains(4294967295.00))
    assert(GeneralFunctions.stringToDoubleBase("4.294.967.295,000", comma_for_decimal = true).contains(4294967295.00))
    //
    assert(GeneralFunctions.stringToDoubleBase(null) == null)
    assert(GeneralFunctions.stringToDoubleBase("") == null)
    assert(GeneralFunctions.stringToDoubleBase(" ") == null)
    assert(GeneralFunctions.stringToDoubleBase("foo") == null)
  }
}

class NormalizeDateMDTest extends FunSuite {
  test("DateTimeFunctions.normalizeDate_md") {
    assert(DateTimeFunctions.normalizeDate_md("1999-03-22").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("19990322+0100").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("19990322").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("1999-03-22 AD").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("1999-03-22+01:00").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("1999-03-22T05:06:07.000[Europe/Paris]").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("1999-03-22T05:06:07.000").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("1999-03-22T05:06:07").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("1999-03-22T05:06:07.000Z").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("1999-03-22T05:06:07.000+01:00").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("1999-03-22T05:06:07+01:00").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("1999-03-22T05:06:07.000+01:00[Europe/Paris]").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("1999-03-22T05:06:07+01:00[Europe/Paris]").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("3/22/99").toString.contains("2099-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("03/22/99").toString.contains("2099-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("03-22-99").toString.contains("2099-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("3-22-99").toString.contains("2099-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("Mar 22, 1999").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("March 22, 1999").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("Monday, March 22, 1999").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("Mar 22 1999").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("March 22 1999").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("03-22-1999").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("3-22-1999").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("1999-03-22+01:00").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("03/22/1999").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("3/22/1999").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("1999/3/22").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("3/22/99 5:06 AM").toString.contains("2099-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("03/22/99 5:06 AM").toString.contains("2099-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("03-22-99 5:06 AM").toString.contains("2099-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("3-22-99 5:06 AM").toString.contains("2099-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("Mar 22, 1999 5:06:07 AM").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("Monday, March 22, 1999 5:06:07 AM CET").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("Mon Mar 22 05:06:07 CET 1999").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("03-22-1999 5:06:07 AM").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("3-22-1999 5:06:07 AM").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("1999-03-22 5:06:07 AM").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("1999-3-22 5:06:07 AM").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("1999-03-22 05:06:07.0").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("03/22/1999 5:06:07 AM").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("3/22/1999 5:06:07 AM").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("03/22/99 5:06:07 AM").toString.contains("2099-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("03/22/99 5:06:07").toString.contains("2099-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("3/22/99 5:06:07").toString.contains("2099-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("03/22/1999 5:06 AM").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("3/22/1999 5:06 AM").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("03-22-99 5:06:07 AM").toString.contains("2099-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("3-22-99 5:06:07 AM").toString.contains("2099-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("03-22-1999 5:06 AM").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("3-22-1999 5:06 AM").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("1999-03-22 5:06 AM").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("1999-3-22 5:06 AM").toString.contains("1999-03-22"))
    assert(DateTimeFunctions.normalizeDate_md("Mar.22.1999").toString.contains("1999-03-22"))
  }
}

class NormalizeTimestampMDTest extends FunSuite {
  test("DateTimeFunctions.normalizeTimestamp_md") {
    assert(DateTimeFunctions.normalizeTimestamp_md("1999-03-22").toString.contains("1999-03-22 00:00:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("19990322+0100").toString.contains("1999-03-22 00:00:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("19990322").toString.contains("1999-03-22 00:00:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("1999-03-22 AD").toString.contains("1999-03-22 00:00:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("1999-03-22+01:00").toString.contains("1999-03-22 00:00:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("1999-03-22T05:06:07.000[Europe/Paris]").toString.contains("1999-03-22 05:06:07.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("1999-03-22T05:06:07.000").toString.contains("1999-03-22 05:06:07.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("1999-03-22T05:06:07").toString.contains("1999-03-22 05:06:07.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("1999-03-22T05:06:07.000Z").toString.contains("1999-03-22 05:06:07.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("1999-03-22T05:06:07.000+01:00").toString.contains("1999-03-22 05:06:07.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("1999-03-22T05:06:07+01:00").toString.contains("1999-03-22 05:06:07.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("1999-03-22T05:06:07.000+01:00[Europe/Paris]").toString.contains("1999-03-22 05:06:07.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("1999-03-22T05:06:07+01:00[Europe/Paris]").toString.contains("1999-03-22 05:06:07.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("3/22/99").toString.contains("2099-03-22 00:00:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("03/22/99").toString.contains("2099-03-22 00:00:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("03-22-99").toString.contains("2099-03-22 00:00:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("3-22-99").toString.contains("2099-03-22 00:00:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("Mar 22, 1999").toString.contains("1999-03-22 00:00:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("March 22, 1999").toString.contains("1999-03-22 00:00:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("Monday, March 22, 1999").toString.contains("1999-03-22 00:00:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("Mar 22 1999").toString.contains("1999-03-22 00:00:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("March 22 1999").toString.contains("1999-03-22 00:00:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("03-22-1999").toString.contains("1999-03-22 00:00:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("3-22-1999").toString.contains("1999-03-22 00:00:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("1999-03-22+01:00").toString.contains("1999-03-22 00:00:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("03/22/1999").toString.contains("1999-03-22 00:00:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("3/22/1999").toString.contains("1999-03-22 00:00:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("1999/3/22").toString.contains("1999-03-22 00:00:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("3/22/99 5:06 AM").toString.contains("2099-03-22 05:06:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("03/22/99 5:06 AM").toString.contains("2099-03-22 05:06:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("03-22-99 5:06 AM").toString.contains("2099-03-22 05:06:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("3-22-99 5:06 AM").toString.contains("2099-03-22 05:06:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("Mar 22, 1999 5:06:07 AM").toString.contains("1999-03-22 05:06:07.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("Monday, March 22, 1999 5:06:07 AM CET").toString.contains("1999-03-22 05:06:07.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("Mon Mar 22 05:06:07 CET 1999").toString.contains("1999-03-22 05:06:07.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("03-22-1999 5:06:07 AM").toString.contains("1999-03-22 05:06:07.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("3-22-1999 5:06:07 AM").toString.contains("1999-03-22 05:06:07.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("1999-03-22 5:06:07 AM").toString.contains("1999-03-22 05:06:07.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("1999-3-22 5:06:07 AM").toString.contains("1999-03-22 05:06:07.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("1999-03-22 05:06:07.0").toString.contains("1999-03-22 05:06:07.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("03/22/1999 5:06:07 AM").toString.contains("1999-03-22 05:06:07.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("3/22/1999 5:06:07 AM").toString.contains("1999-03-22 05:06:07.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("03/22/99 5:06:07 AM").toString.contains("2099-03-22 05:06:07.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("03/22/99 5:06:07").toString.contains("2099-03-22 05:06:07.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("3/22/99 5:06:07").toString.contains("2099-03-22 05:06:07.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("03/22/1999 5:06 AM").toString.contains("1999-03-22 05:06:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("3/22/1999 5:06 AM").toString.contains("1999-03-22 05:06:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("03-22-99 5:06:07 AM").toString.contains("2099-03-22 05:06:07.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("3-22-99 5:06:07 AM").toString.contains("2099-03-22 05:06:07.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("03-22-1999 5:06 AM").toString.contains("1999-03-22 05:06:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("3-22-1999 5:06 AM").toString.contains("1999-03-22 05:06:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("1999-03-22 5:06 AM").toString.contains("1999-03-22 05:06:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("1999-3-22 5:06 AM").toString.contains("1999-03-22 05:06:00.0"))
    assert(DateTimeFunctions.normalizeTimestamp_md("Mar.22.1999").toString.contains("1999-03-22 00:00:00.0"))
  }
}
